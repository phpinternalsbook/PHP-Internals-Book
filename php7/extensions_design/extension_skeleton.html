
<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.19: https://docutils.sourceforge.io/" />

    <title>A look into a PHP extension and extension skeleton &#8212; PHP Internals Book</title>
    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/haiku.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/style.css" />
    <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
    <script src="../../_static/jquery.js"></script>
    <script src="../../_static/underscore.js"></script>
    <script src="../../_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="../../_static/doctools.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Registering and using PHP functions" href="php_functions.html" />
    <link rel="prev" title="Learning the PHP lifecycle" href="php_lifecycle.html" /> 
  </head><body>
      <div class="header" role="banner"><h1 class="heading"><a href="../../index.html">
          <span>PHP Internals Book</span></a></h1>
        <h2 class="heading"><span>A look into a PHP extension and extension skeleton</span></h2>
      </div>
      <div class="topnav" role="navigation" aria-label="top navigation">
      
        <p>
        «&#160;&#160;<a href="php_lifecycle.html">Learning the PHP lifecycle</a>
        &#160;&#160;::&#160;&#160;
        <a class="uplink" href="../../index.html">Contents</a>
        &#160;&#160;::&#160;&#160;
        <a href="php_functions.html">Registering and using PHP functions</a>&#160;&#160;»
        </p>

      </div>
      <div class="content" role="main">
        
        
  <section id="a-look-into-a-php-extension-and-extension-skeleton">
<h1>A look into a PHP extension and extension skeleton<a class="headerlink" href="#a-look-into-a-php-extension-and-extension-skeleton" title="Permalink to this heading">¶</a></h1>
<p>Here we detail what a PHP extension look like, and how to generate a skeleton using some tools. That will allow us to
use a skeleton code and hack into it, instead of creating every needed piece by hand from scratch.</p>
<p>We’ll also detail how you could/should organize your extension files, how the engine loads them, and basically
everything you need to know about a PHP extension.</p>
<section id="how-the-engine-loads-extensions">
<h2>How the engine loads extensions<a class="headerlink" href="#how-the-engine-loads-extensions" title="Permalink to this heading">¶</a></h2>
<p>You remember <a class="reference internal" href="../build_system/building_extensions.html"><span class="doc">the chapter about building PHP extensions</span></a>, so you know how
to compile/build it and install it.</p>
<p>You may build <strong>statically compiled</strong> extensions, those are extensions that are part of PHP’s heart and melt into it.
They are not represented as <em>.so</em> files, but as <em>.o</em> objects that are linked into the final PHP executable (ELF). Thus,
such extensions cannot be disabled, they are part of the PHP executable body code : they are here, in, whatever you say
and do. Some extensions are required to be statically built, f.e <em>ext/core</em>, <em>ext/standard</em>, <em>ext/spl</em> and
<em>ext/mysqlnd</em> (non-exhaustive list).</p>
<p>You can find the list of statically compiled extensions by looking at the <code class="docutils literal notranslate"><span class="pre">main/internal_functions.c</span></code> that is
generated while you compile PHP. This step is detailed in
<a class="reference internal" href="../build_system/building_php.html"><span class="doc">the chapter about building PHP</span></a>.</p>
<p>Then, you may also build <strong>dynamically loaded</strong> extensions. Those are the famous <em>extension.so</em> files that are born at
the end of the individual compilation process. Dynamically loaded extensions offer the advantage to be pluggable and
unpluggable at runtime, and don’t require a recompilation of all PHP to be enabled or disabled. The drawback is that
the PHP process startup time is longer when it must load .so files. But that’s a matter of milliseconds and you don’t
really suffer from that.</p>
<p>Another drawback of dynamically loaded extensions is the extension loading order. Some extensions may require other
ones to be loaded before them. Although this is not a good practice, we’ll see that PHP extension system allows you to
declare dependencies to master such an order, but dependencies are usually a bad idea and should be avoided.</p>
<p>Last thing : PHP statically compiled extensions start before dynamically compiled ones. That means that their
<code class="docutils literal notranslate"><span class="pre">MINIT()</span></code> is called before extensions.so files’ <code class="docutils literal notranslate"><span class="pre">MINIT()</span></code>.</p>
<p>When PHP starts, it quickly goes to parse its different INI files. If present, those later may declare extensions to
load using the <em>“extension=some_ext.so”</em> line reference.
PHP then collects every extension parsed from INI configuration, and will try to load them in the same order they’ve
been added to the INI file, until some extensions declared some dependencies (which will then be loaded before).</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>If you use an operating system package manager, you may have noticed that packagers usually name their
extension file with heading numbers, aka <em>00_ext.ini</em>, <em>01_ext.ini</em> etc… This is to master the order
extensions will be loaded. Some uncommon extensions require a specific order to be run. We’d like to remind
you that depending on other extensions to be loaded before yours is a bad idea.</p>
</div>
<p>To load extensions, <a class="reference external" href="https://en.wikipedia.org/wiki/Dynamic_loading">libdl</a> and its
<a class="reference external" href="http://www.unix.com/man-page/All/3lib/libdl/">dlopen()/dlsym()</a> functions are used.</p>
<p>The symbol that is looked for is the <code class="docutils literal notranslate"><span class="pre">get_module()</span></code> symbol, that means that you extension must export it to be loaded.
This is usually the case, as if you used the skeleton script (we’ll foresee it in a minute), then that later generated
code using the <code class="docutils literal notranslate"><span class="pre">ZEND_GET_MODULE(your_ext)</span></code> macro, which looks like:</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="cp">#define ZEND_GET_MODULE(name) \</span>
<span class="cp">    BEGIN_EXTERN_C()\</span>
<span class="cp">    ZEND_DLEXPORT zend_module_entry *get_module(void) { return &amp;name##_module_entry; }\</span>
<span class="cp">    END_EXTERN_C()</span>
</pre></div>
</div>
<p>Like you can see, that macro when used declares a global symbol : the get_module() function that will get called by the
engine once wanting to load your extension.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The source code PHP uses to load extensions is located into
<a class="reference external" href="https://github.com/php/php-src/blob/27d681435174433c3a9b0b8325361dfa383be0a6/ext/standard/dl.c#L90">ext/standard/dl.c</a></p>
</div>
</section>
<section id="what-is-a-php-extension">
<h2>What is a PHP extension ?<a class="headerlink" href="#what-is-a-php-extension" title="Permalink to this heading">¶</a></h2>
<p>A PHP extension, not to be confused with a <a class="reference internal" href="zend_extensions.html"><span class="doc">Zend extension</span></a>, is set up by the usage of a
<code class="docutils literal notranslate"><span class="pre">zend_module_entry</span></code> structure:</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="k">struct</span><span class="w"> </span><span class="nc">_zend_module_entry</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="kt">unsigned</span><span class="w"> </span><span class="kt">short</span><span class="w"> </span><span class="n">size</span><span class="p">;</span><span class="w">                                </span><span class="cm">/*</span>
<span class="cm">    unsigned int zend_api;                               * STANDARD_MODULE_HEADER</span>
<span class="cm">    unsigned char zend_debug;                            *</span>
<span class="cm">    unsigned char zts;                                   */</span><span class="w"></span>

<span class="w">    </span><span class="k">const</span><span class="w"> </span><span class="k">struct</span><span class="w"> </span><span class="nc">_zend_ini_entry</span><span class="w"> </span><span class="o">*</span><span class="n">ini_entry</span><span class="p">;</span><span class="w">            </span><span class="cm">/* Unused */</span><span class="w"></span>
<span class="w">    </span><span class="k">const</span><span class="w"> </span><span class="k">struct</span><span class="w"> </span><span class="nc">_zend_module_dep</span><span class="w"> </span><span class="o">*</span><span class="n">deps</span><span class="p">;</span><span class="w">                </span><span class="cm">/* Module dependencies */</span><span class="w"></span>
<span class="w">    </span><span class="k">const</span><span class="w"> </span><span class="kt">char</span><span class="w"> </span><span class="o">*</span><span class="n">name</span><span class="p">;</span><span class="w">                                   </span><span class="cm">/* Module name */</span><span class="w"></span>
<span class="w">    </span><span class="k">const</span><span class="w"> </span><span class="k">struct</span><span class="w"> </span><span class="nc">_zend_function_entry</span><span class="w"> </span><span class="o">*</span><span class="n">functions</span><span class="p">;</span><span class="w">       </span><span class="cm">/* Module published functions */</span><span class="w"></span>

<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="p">(</span><span class="o">*</span><span class="n">module_startup_func</span><span class="p">)(</span><span class="n">INIT_FUNC_ARGS</span><span class="p">);</span><span class="w">         </span><span class="cm">/*</span>
<span class="cm">    int (*module_shutdown_func)(SHUTDOWN_FUNC_ARGS);     *</span>
<span class="cm">    int (*request_startup_func)(INIT_FUNC_ARGS);         * Lifetime functions (hooks)</span>
<span class="cm">    int (*request_shutdown_func)(SHUTDOWN_FUNC_ARGS);    *</span>
<span class="cm">    void (*info_func)(ZEND_MODULE_INFO_FUNC_ARGS);       */</span><span class="w"></span>

<span class="w">    </span><span class="k">const</span><span class="w"> </span><span class="kt">char</span><span class="w"> </span><span class="o">*</span><span class="n">version</span><span class="p">;</span><span class="w">                                </span><span class="cm">/* Module version */</span><span class="w"></span>

<span class="w">    </span><span class="kt">size_t</span><span class="w"> </span><span class="n">globals_size</span><span class="p">;</span><span class="w">                                </span><span class="cm">/*</span>
<span class="cm">#ifdef ZTS                                               *</span>
<span class="cm">    ts_rsrc_id* globals_id_ptr;                          *</span>
<span class="cm">#else                                                    * Globals management</span>
<span class="cm">    void* globals_ptr;                                   *</span>
<span class="cm">#endif                                                   *</span>
<span class="cm">    void (*globals_ctor)(void *global);                  *</span>
<span class="cm">    void (*globals_dtor)(void *global);                  */</span><span class="w"></span>

<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="p">(</span><span class="o">*</span><span class="n">post_deactivate_func</span><span class="p">)(</span><span class="kt">void</span><span class="p">);</span><span class="w">                   </span><span class="cm">/* Rarely used lifetime hook */</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">module_started</span><span class="p">;</span><span class="w">                                  </span><span class="cm">/* Has module been started (internal usage) */</span><span class="w"></span>
<span class="w">    </span><span class="kt">unsigned</span><span class="w"> </span><span class="kt">char</span><span class="w"> </span><span class="n">type</span><span class="p">;</span><span class="w">                                  </span><span class="cm">/* Module type (internal usage) */</span><span class="w"></span>
<span class="w">    </span><span class="kt">void</span><span class="w"> </span><span class="o">*</span><span class="n">handle</span><span class="p">;</span><span class="w">                                        </span><span class="cm">/* dlopen() returned handle */</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">module_number</span><span class="p">;</span><span class="w">                                   </span><span class="cm">/* module number among others */</span><span class="w"></span>
<span class="w">    </span><span class="k">const</span><span class="w"> </span><span class="kt">char</span><span class="w"> </span><span class="o">*</span><span class="n">build_id</span><span class="p">;</span><span class="w">                                </span><span class="cm">/* build id, part of STANDARD_MODULE_PROPERTIES_EX */</span><span class="w"></span>
<span class="p">};</span><span class="w"></span>
</pre></div>
</div>
<p>The four first parameters have already been explained in
<a class="reference internal" href="../build_system/building_extensions.html"><span class="doc">the building extensions chapter</span></a>. They are usually filled-in using the
<code class="docutils literal notranslate"><span class="pre">STANDARD_MODULE_HEADER</span></code> macro.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">ini_entry</span></code> vector is actually unused. You <a class="reference internal" href="ini_settings.html"><span class="doc">register INI entries</span></a> using special macros.</p>
<p>Then you may declare dependencies, that means that your extension could need another extension to be loaded before it,
or could declare a conflict with another extensions. This is done using the <code class="docutils literal notranslate"><span class="pre">deps</span></code> field. In reality, this is very
uncommonly used, and more generally it is a bad practice to create dependencies across PHP extensions.</p>
<p>After that you declare a <code class="docutils literal notranslate"><span class="pre">name</span></code>. Nothing to say, this name is the name of your extension (which can be different from
the name of its own <em>.so</em> file). Take care the name is case sensitive in most operations, we suggest you use something
short, lower case, with no spaces (to make things a bit easier).</p>
<p>Then come the <code class="docutils literal notranslate"><span class="pre">functions</span></code> field. It is a pointer to some PHP functions that extension wants to register into
the engine. We talked about that <a class="reference internal" href="php_functions.html"><span class="doc">in a dedicated chapter</span></a>.</p>
<p>Keeping-on come the 5 lifetime hooks. <a class="reference internal" href="php_lifecycle.html"><span class="doc">See their dedicated chapter</span></a>.</p>
<p>Your extension may publish a version number, as a <code class="docutils literal notranslate"><span class="pre">char</span> <span class="pre">*</span></code>, using the <code class="docutils literal notranslate"><span class="pre">version</span></code> field. This field is only read as
part of your extension information, that is by phpinfo() or by the reflection API as
<code class="docutils literal notranslate"><span class="pre">ReflectionExtension::getVersion()</span></code>.</p>
<p>We next see a lot of fields about globals. Globals management <a class="reference internal" href="globals_management.html"><span class="doc">has a dedicated chapter</span></a>.</p>
<p>Finally the ending fields are usually part of the <code class="docutils literal notranslate"><span class="pre">STANDARD_MODULE_PROPERTIES</span></code> macro and you don’t have to play with
them by hand. The engine will give you a <code class="docutils literal notranslate"><span class="pre">module_number</span></code> for its internal management, and the extension type will be
set to <code class="docutils literal notranslate"><span class="pre">MODULE_PERSISTENT</span></code>. It could be <code class="docutils literal notranslate"><span class="pre">MODULE_TEMPORARY</span></code> as if you extension were loaded using PHP’s userland
<code class="docutils literal notranslate"><span class="pre">dl()</span></code> function, but that use-case is very uncommon, doesn’t work with every SAPI and temporary extensions usually
lead to many problems into the engine.</p>
</section>
<section id="generating-extension-skeleton-with-scripts">
<h2>Generating extension skeleton with scripts<a class="headerlink" href="#generating-extension-skeleton-with-scripts" title="Permalink to this heading">¶</a></h2>
<p>Now we’ll see how to generate an extension skeleton so that you may start a new extension with some minimal content
and structure you won’t be forced to create by hand from scratch.</p>
<p>the skeleton generator script is located into
<a class="reference external" href="https://github.com/php/php-src/blob/27d681435174433c3a9b0b8325361dfa383be0a6/ext/ext_skel">php-src/ext/ext_skel</a> and
the structure it uses as a template is stored into
<a class="reference external" href="https://github.com/php/php-src/tree/27d681435174433c3a9b0b8325361dfa383be0a6/ext/skeleton">php-src/ext/skeleton</a></p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The script and the structure move a little bit as PHP versions move forward.</p>
</div>
<p>You can analyze those scripts to see how they work, but the basic usage is:</p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>&gt; <span class="nb">cd</span> /tmp
/tmp&gt; /path/to/php/ext/ext_skel --skel<span class="o">=</span>/path/to/php/ext/skeleton --extname<span class="o">=</span>pib
<span class="o">[</span> ... generating ... <span class="o">]</span>
/tmp&gt; tree pib/
pib/
├── config.m4
├── config.w32
├── CREDITS
├── EXPERIMENTAL
├── php_pib.h
├── pib.c
├── pib.php
└── tests
    └── <span class="m">001</span>.phpt
/tmp&gt;
</pre></div>
</div>
<p>You can see a very basic an minimal structure that got generated. You’ve learnt in the building extension chapter that
the to-be-compiled files of your extension must be declared into <em>config.m4</em>. The skeleton only generated
<em>&lt;your-ext-name&gt;.c</em> file. For the example, we called the extension <em>“pib”</em> so we got a <em>pib.c</em> file and we must
uncomment the <em>–enable-pib</em> line in <em>config.m4</em> for it to get compiled.</p>
<p>Every C file comes with a header file (usually). Here, the structure is <em>php_&lt;your-ext-name&gt;.h</em> , so <em>php_pib.h</em> for
us. Don’t change that name, the building system expects such a naming convention for the header file.</p>
<p>You can see that a minimal test structure has been generated as well.</p>
<p>Let’s open <em>pib.c</em>. In there, everything is commented out, so we won’t have too many lines to write here.</p>
<p>Basically, we can see that the module symbol needed by the engine to load our extension is published here:</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="cp">#ifdef COMPILE_DL_PIB</span>
<span class="cp">#ifdef ZTS</span>
<span class="n">ZEND_TSRMLS_CACHE_DEFINE</span><span class="p">()</span><span class="w"></span>
<span class="cp">#endif</span>
<span class="n">ZEND_GET_MODULE</span><span class="p">(</span><span class="n">pib</span><span class="p">)</span><span class="w"></span>
<span class="cp">#endif</span>
</pre></div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">COMPILE_DL_&lt;YOUR-EXT-NAME&gt;</span></code> macro is defined if you pass <em>–enable-&lt;my-ext-name&gt;</em> flag to configure script. We
also see that in case of ZTS mode, the TSRM local storage pointer is defined as part of <code class="docutils literal notranslate"><span class="pre">ZEND_TSRMLS_CACHE_DEFINE()</span></code>
macro.</p>
<p>After that, there is nothing more to say as everything is commented out and should be clear to you.</p>
</section>
<section id="new-age-of-the-extension-skeleton-generator">
<h2>New age of the extension skeleton generator<a class="headerlink" href="#new-age-of-the-extension-skeleton-generator" title="Permalink to this heading">¶</a></h2>
<p>Since <a class="reference external" href="https://github.com/php/php-src/commit/f35f45906eac34498c7720326fb9da9fde960871">this commit</a> and the
extension skeleton generator had took a new style :</p>
<blockquote>
<div><p>It will now run on Windows without Cygwin and other nonsense.
It no longer includes a way to generate XML documentation (the PHP documentation utilities already got tools for that
in svn under phpdoc/doc-base) and it no longer support function stubs.</p>
</div></blockquote>
<p>and here is the available options :</p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>php ext_skel.php --ext &lt;name&gt; <span class="o">[</span>--experimental<span class="o">]</span> <span class="o">[</span>--author &lt;name&gt;<span class="o">]</span>
                 <span class="o">[</span>--dir &lt;path&gt;<span class="o">]</span> <span class="o">[</span>--std<span class="o">]</span> <span class="o">[</span>--onlyunix<span class="o">]</span>
                 <span class="o">[</span>--onlywindows<span class="o">]</span> <span class="o">[</span>--help<span class="o">]</span>

  --ext &lt;name&gt;              The name of the extension defined as &lt;name&gt;
  --experimental    Passed <span class="k">if</span> this extension is experimental, this creates
                        the EXPERIMENTAL file <span class="k">in</span> the root of the extension
  --author &lt;name&gt;       Your name, this is used <span class="k">if</span> --header is passed and
                        <span class="k">for</span> the CREDITS file
  --dir &lt;path&gt;              Path to the directory <span class="k">for</span> where extension should be
                        created. Defaults to the directory of where this script
                    lives
  --std                     If passed, the standard header and vim rules footer used
                    <span class="k">in</span> extensions that is included <span class="k">in</span> the core, will be used
  --onlyunix                Only generate configure scripts <span class="k">for</span> Unix
  --onlywindows             Only generate configure scripts <span class="k">for</span> Windows
  --help                This <span class="nb">help</span>
</pre></div>
</div>
<p>The new extension skeleton generator will generate skeleton with three fixed functions,
you may define any others functions and change the concrete body as you want.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Remember that the new ext_skel is no longer support proto files.</p>
</div>
</section>
<section id="publishing-api">
<h2>Publishing API<a class="headerlink" href="#publishing-api" title="Permalink to this heading">¶</a></h2>
<p>If we open the header file, we can see those lines:</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="cp">#ifdef PHP_WIN32</span>
<span class="cp">#   define PHP_PIB_API __declspec(dllexport)</span>
<span class="cp">#elif defined(__GNUC__) &amp;&amp; __GNUC__ &gt;= 4</span>
<span class="cp">#   define PHP_PIB_API __attribute__ ((visibility(&quot;default&quot;)))</span>
<span class="cp">#else</span>
<span class="cp">#   define PHP_PIB_API</span>
<span class="cp">#endif</span>
</pre></div>
</div>
<p>Those lines define a macro named <code class="docutils literal notranslate"><span class="pre">PHP_&lt;EXT-NAME&gt;_API</span></code> (for us <code class="docutils literal notranslate"><span class="pre">PHP_PIB_API</span></code>) and it resolves to the
<a class="reference external" href="https://gcc.gnu.org/onlinedocs/gcc/Common-Function-Attributes.html#Common-Function-Attributes">GCC custom attribute</a>
visibility(“default”).</p>
<p>In C, you can tell the linker to hide every symbol from the final object. This is what’s done in PHP, for every
symbol, not only static ones (which are by definition not published).</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>The default PHP compilation line tells the compiler to hide every symbol and not export them.</p>
</div>
<p>You should then “unhide” the symbols you’d like your extension to publish for those to be used in other extensions or
other parts of the final ELF file.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Remember that you can read published and hidden symbol of an ELF using <code class="docutils literal notranslate"><span class="pre">nm</span></code> under Unix.</p>
</div>
<p>We can’t explain those concepts in deep here, perhaps such links could help you ?</p>
<ul class="simple">
<li><p><a class="reference external" href="https://gcc.gnu.org/wiki/Visibility">https://gcc.gnu.org/wiki/Visibility</a></p></li>
<li><p><a class="reference external" href="http://www.iecc.com/linker/linker10.html">http://www.iecc.com/linker/linker10.html</a></p></li>
<li><p><a class="reference external" href="https://www.akkadia.org/drepper/dsohowto.pdf">https://www.akkadia.org/drepper/dsohowto.pdf</a></p></li>
<li><p><a class="reference external" href="http://www.faqs.org/docs/Linux-HOWTO/Program-Library-HOWTO.html">http://www.faqs.org/docs/Linux-HOWTO/Program-Library-HOWTO.html</a></p></li>
<li><p><a class="reference external" href="https://developer.apple.com/library/content/documentation/DeveloperTools/Conceptual/DynamicLibraries/000-Introduction/Introduction.html">https://developer.apple.com/library/content/documentation/DeveloperTools/Conceptual/DynamicLibraries/000-Introduction/Introduction.html</a></p></li>
</ul>
<p>So basically, if you want a C symbol of yours to be publicly available to other extensions, you should declare it
using the special <code class="docutils literal notranslate"><span class="pre">PHP_PIB_API</span></code> macro. The traditional use-case for that is to publish the classes symbols
(<code class="docutils literal notranslate"><span class="pre">zend_class_entry*</span></code> type) so that other extensions can hook into your own published classes and replace some of their
handlers.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Please, note that this only works with the traditional PHP. If you use
<a class="reference internal" href="../build_system/building_php.html"><span class="doc">a PHP from a Linux distribution</span></a>, those are patched to resolve symbols
at load time and not lazilly, thus this trick doesn’t work.</p>
</div>
</section>
</section>


      </div>
      <div class="bottomnav" role="navigation" aria-label="bottom navigation">
      
        <p>
        «&#160;&#160;<a href="php_lifecycle.html">Learning the PHP lifecycle</a>
        &#160;&#160;::&#160;&#160;
        <a class="uplink" href="../../index.html">Contents</a>
        &#160;&#160;::&#160;&#160;
        <a href="php_functions.html">Registering and using PHP functions</a>&#160;&#160;»
        </p>

      </div>

    <div class="footer feedback">
        The repository for this book is available on <a href="https://github.com/phpinternalsbook/PHP-Internals-Book">GitHub</a>.
        <br/><br/>
        <a rel="license" href="http://creativecommons.org/licenses/by-nc-sa/4.0/">
            <img alt="Creative Commons License" style="border-width:0" src="https://i.creativecommons.org/l/by-nc-sa/4.0/88x31.png" />
        </a>
        <br />
        The PHP internals book is licensed under a <a rel="license" href="http://creativecommons.org/licenses/by-nc-sa/4.0/">Creative Commons Attribution-NonCommercial-ShareAlike 4.0 International License</a>.
    </div>
    <script>
      (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
      })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

      ga('create', 'UA-41617167-1', 'phpinternalsbook.com');
      ga('send', 'pageview');
    </script>

  </body>
</html>